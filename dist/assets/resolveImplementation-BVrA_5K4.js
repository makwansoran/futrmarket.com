import{i as p,aU as d,S as l,aO as c,y as f}from"./index-Cn3kq7oy.js";import{readContract as u}from"./read-contract-D2Vq_7_K.js";import"./utils-K5Uh5N8m.js";import"./to-serializable-transaction-CINlwqk-.js";async function r(e,t){return await e({method:"eth_getStorageAt",params:[p(t.address),t.position,t.blockTag??"latest"]})}function x(e){if(e.startsWith("0x")||(e=`0x${e}`),e.startsWith("0x363d3d373d3d3d363d73"))return`0x${e.slice(22,62)}`;if(e.startsWith("0x36603057343d5230"))return`0x${e.slice(122,162)}`;if(e.startsWith("0x3d3d3d3d363d3d37363d73"))return`0x${e.slice(24,64)}`;if(e.startsWith("0x366000600037611000600036600073"))return`0x${e.slice(32,72)}`;if(e.startsWith("0x36600080376020600036600073"))return`0x${e.slice(28,68)}`;if(e.startsWith("0x365f5f375f5f365f73"))return`0x${e.slice(20,60)}`;if(e.length===48&&e.startsWith("0xef0100"))return`0x${e.slice(8,48)}`}const o="0x0000000000000000000000000000000000000000",A="0x0000000000000000000000000000000000000000000000000000000000000000";async function B(e){const[t,s]=await Promise.all([d(e),g(e)]),n=x(t);if(n)return{address:n,bytecode:await d(l({...e,address:n}))};s&&s!==o&&(e=l({...e,address:s}));const a=await Promise.all([h(e),y(e)]);for(const i of a)if(i&&c(i)&&i!==o){const m=await d({...e,address:i});return m==="0x"?{address:e.address,bytecode:t}:{address:i,bytecode:m}}return{address:e.address,bytecode:t}}async function g(e){const t=f({chain:e.chain,client:e.client});try{const s=await r(t,{address:e.address,position:"0xa3f0ad74e5423aebfd80d3ef4346578335a9a72aeaee59ff6cb3582b35133d50"});return s.length>=40?`0x${s.slice(-40)}`:void 0}catch{return}}async function h(e){const t=f({chain:e.chain,client:e.client});try{const s=[r(t,{address:e.address,position:"0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc"}),r(t,{address:e.address,position:"0xbaab7dbf64751104133af04abc7d9979f0fda3b059a322a8333f533d3f32bf7f"}),r(t,{address:e.address,position:"0x7050c9e0f4ca769c69bd3a8ef740bc37934f8e2c036e5a723fd8ee048ed3f8c3"})],a=(await Promise.all(s)).find(i=>i!==A);return a?`0x${a.slice(-40)}`:o}catch{return}}const S={inputs:[],name:"implementation",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"};async function y(e){try{return await u({contract:e,method:S})}catch{return}}export{B as resolveImplementation};
